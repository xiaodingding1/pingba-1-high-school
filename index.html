<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>高一学部守楼层</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="hidden-before-load">

<div class="card"><h2 id="mainTitle">期中监考楼层选择</h2></div>
<div class="card"><label>姓名：<br><input type="text" id="teacherName"></label></div>
<div class="card"><h3>请选择两个楼层：</h3><div id="floors"></div><button id="submitBtn">提交选择</button></div>
<div class="card"><h3>当前所有选择情况：</h3><div id="publicBoard" class="selected-list"></div></div>

<div class="card">
  <h3>设置</h3>
  <button class="danger" id="resetBtn">⚠ 重置全部投票</button>
  <button id="openTitleBtn">修改投票标题</button>
  <button id="viewDetailsBtn">查看投票详细信息</button>
  <button id="changePwdBtn">修改密码</button>
</div>

<!-- 投票标题修改 modal -->
<div id="modalBg" class="modal-bg">
  <div class="modal">
    <h3>修改投票标题</h3>
    <input type="text" id="newTitleInput" placeholder="请输入新的标题"><br><br>
    <button id="saveTitleBtn">保存</button>
    <button class="danger" id="closeTitleBtn">关闭</button>
  </div>
</div>

<!-- 修改密码 modal -->
<div id="pwdModalBg" class="modal-bg">
  <div class="modal">
    <h3>修改密码</h3>
    <input id="oldPwdInput" type="password" placeholder="请输入原密码"><br><br>
    <input id="newPwdInput" type="password" placeholder="请输入新密码"><br><br>
    <button id="confirmChangePwdBtn">确认修改</button>
    <button class="danger" id="closePwdBtn">关闭</button>
  </div>
</div>

<!-- 重置投票 modal -->
<div id="resetPwdModal" class="modal-bg">
  <div class="modal">
    <h3>请输入重置密码</h3>
    <input type="password" id="resetPwdInput" placeholder="请输入密码"><br><br>
    <button id="confirmResetBtn">确认</button>
    <button class="danger" id="closeResetBtn">取消</button>
  </div>
</div>

<script src="libs/av-min.js"></script>
<script src="app.js"></script>
<script>
window.addEventListener('DOMContentLoaded', () => {
  const resetBtn = document.getElementById('resetBtn');
  if (resetBtn) resetBtn.addEventListener('click', openResetModal);

  const openTitleBtn = document.getElementById('openTitleBtn');
  if (openTitleBtn) openTitleBtn.addEventListener('click', openModal);

  const closeTitleBtn = document.getElementById('closeTitleBtn');
  if (closeTitleBtn) closeTitleBtn.addEventListener('click', closeModal);

  const saveTitleBtn = document.getElementById('saveTitleBtn');
  if (saveTitleBtn) saveTitleBtn.addEventListener('click', saveNewTitle);

  const submitBtn = document.getElementById('submitBtn');
  if (submitBtn) submitBtn.addEventListener('click', submitChoiceHandler);

  const viewBtn = document.getElementById('viewDetailsBtn');
  if (viewBtn) viewBtn.addEventListener('click', goToDetails);

  const changePwdBtn = document.getElementById('changePwdBtn');
  if (changePwdBtn) changePwdBtn.addEventListener('click', changePwdViaPrompt);

  const resetCloseBtn = document.getElementById('closeResetBtn');
  if (resetCloseBtn) resetCloseBtn.addEventListener('click', closeResetModal);

  const confirmResetBtn = document.getElementById('confirmResetBtn');
  if (confirmResetBtn) confirmResetBtn.addEventListener('click', confirmResetAll);
});
</script>
</body>
</html>
